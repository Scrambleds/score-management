<div class="custom-card">
  <div class="card-body">
    <div class="fw-bold">รายละเอียด</div>
    <!-- parent will submit this form instead -->
    <form [formGroup]="form" class="w-100">
      <div class="row">
        <!-- Subject Code -->
        <div class="col-6 col-sm-5 col-md-2">
          <label for="subjectNo" class="fw-bold mb-2">{{
            "subject_code" | translate
          }}</label>
          <div class="input-group-autocomplete mb-2">
            <app-autocomplete
              #subjectCode
              id="subjectCode"
              [name]="'subjectCode'"
              formControlName="subjectCode"
              [placeholder]="'placeholder_text' | translate"
              [suggestions]="filteredSubjects"
              [displayKey]="'subjectCode'"
              [displayFormat]="customFormat"
              [widthAuto]="true"
              (search)="searchCode($event)"
              (select)="selectCode($event)"
              [value]="form.get('subjectCode')?.value"
              [disabled]="!isUploaded"
            ></app-autocomplete>

            <ng-template #customFormat let-item>
              {{ item.subjectCode }} - {{ item.subjectName }}
            </ng-template>
          </div>
          <div
            *ngIf="
              form.get('subjectCode')?.touched &&
              form.get('subjectCode')?.invalid
            "
            class="text-danger ps-2"
          >
            {{ "alert_enterData" | translate }}
          </div>
        </div>

        <!-- Subject Name -->
        <div class="col-6 col-sm-7 col-md-4">
          <label for="subjectName" class="fw-bold mb-2">{{
            "subject_name" | translate
          }}</label>
          <app-autocomplete
            id="subjectName"
            [name]="'subjectName'"
            formControlName="subjectName"
            [placeholder]="'placeholder_text' | translate"
            [suggestions]="filteredSubjects"
            [displayKey]="'subjectName'"
            [displayFormat]="customFormat"
            (search)="searchSubject($event)"
            (select)="selectSubject($event)"
            [readonly]="isSubjectNameReadonly"
            [value]="form.get('subjectName')!.value"
            [disabled]="!isUploaded"
          ></app-autocomplete>

          <ng-template #customFormat let-item>
            {{ item.subjectCode }} - {{ item.subjectName }}
          </ng-template>
          <!-- (select)="
          !isSubjectNameReadonly &&
            selectSubject($event.subjectCode, $event.subjectName)
        " -->
        </div>

        <!-- Academic Year -->
        <div class="col-6 col-sm-4 col-md-2">
          <label for="academic_year" class="fw-bold mb-2">{{
            "academic_year" | translate
          }}</label>
          <ng-select
            name="academicYearCode"
            formControlName="academicYearCode"
            [items]="academicYearCodeOptions"
            bindLabel="label"
            bindValue="value"
            [placeholder]="'placeholder_select' | translate"
            [clearable]="true"
            (change)="onSelectChange($event, 'academicYearCode')"
          >
          </ng-select>
          <div
            *ngIf="
              form.get('academicYearCode')?.touched &&
              form.get('academicYearCode')?.invalid
            "
            class="text-danger ps-2"
          >
            {{ "alert_enterData" | translate }}
          </div>
        </div>

        <!-- Semester -->
        <div class="col-6 col-sm-4 col-md-2">
          <label for="semester" class="fw-bold mb-2">{{
            "semester" | translate
          }}</label>
          <ng-select
            name="semesterCode"
            formControlName="semesterCode"
            [items]="semesterCodeOptions"
            bindLabel="label"
            bindValue="value"
            [placeholder]="'placeholder_select' | translate"
            [clearable]="true"
            (change)="onSelectChange($event, 'semesterCode')"
          >
          </ng-select>
          <div
            *ngIf="
              form.get('semesterCode')?.touched &&
              form.get('semesterCode')?.invalid
            "
            class="text-danger ps-2"
          >
            {{ "alert_enterData" | translate }}
          </div>
        </div>

        <!-- Section -->
        <div class="col-6 col-sm-4 col-md-2">
          <label for="sectionCode" class="fw-bold mb-2">{{
            "section" | translate
          }}</label>
          <ng-select
            name="sectionCode"
            formControlName="sectionCode"
            [items]="sectionCodeOptions"
            bindLabel="label"
            bindValue="value"
            [placeholder]="'placeholder_select' | translate"
            [clearable]="true"
            (change)="onSelectChange($event, 'sectionCode')"
          >
          </ng-select>
          <div
            *ngIf="
              form.get('sectionCode')?.touched &&
              form.get('sectionCode')?.invalid
            "
            class="text-danger ps-2"
          >
            {{ "alert_enterData" | translate }}
          </div>
        </div>
      </div>
    </form>
  </div>
</div>
