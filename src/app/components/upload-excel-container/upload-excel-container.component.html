<div
  *ngIf="!isFileUploaded"
  class="custom-card"
  style="border: 1px dashed; width: 100%; height: 100%"
>
  <div
    class="card-body w-100"
    (dragover)="onDragOver($event)"
    (drop)="onDrop($event)"
  >
    <div class="text-center">{{ titleName }}</div>
    <label for="uploadfile" class="btn btn-primary">
      <i
        class="bi bi-box-arrow-in-down"
        style="font-size: var(--icon-size); color: var(--white-color)"
      ></i>
      {{ buttonName }}
    </label>
    <input id="uploadfile" type="file" class="d-none" />
  </div>
</div>

<div *ngIf="isFileUploaded" class="custom-card">
  <div class="card-body w-100 gx-0">
    <!-- header -->
    <div class="row gx-0 w-100">
      <div class="w-100 mb-2">
        <div class="fw-bold text-start">ตารางคะแนน</div>
      </div>
      <div class="col-12 col-md-8 mb-2">
        <form
          [formGroup]="form"
          (ngSubmit)="onSubmitFilter()"
          class="w-100 mb-0"
        >
          <div class="row gx-2 w-100">
            <div class="col-12 col-md-6">
              <label
                for="subjectNo"
                class="fw-bold mb-2 mw-100"
                style="
                  white-space: nowrap;
                  overflow: hidden;
                  text-overflow: ellipsis;
                "
                >รหัสนิสิต/ชื่อนิสิต/อีเมล</label
              >
              <div
                class="input-group-autocomplete mw-100"
                style="
                  white-space: nowrap;
                  overflow: hidden;
                  text-overflow: ellipsis;
                "
              >
                <input
                  class="form-control"
                  formControlName="search"
                  type="text"
                  name="search"
                  [placeholder]="'placeholder_text' | translate"
                />
              </div>
            </div>
            <div class="col-12 col-md-3">
              <label for="subjectNo" class="fw-bold mb-2">รหัสสาขา</label>
              <ng-select
                id="majorCode"
                class="w-100"
                formControlName="majorCode"
                [items]="majorCodeOptions"
                bindLabel="label"
                bindValue="value"
                [placeholder]="'placeholder_select' | translate"
                [clearable]="true"
                (change)="onSelectChange($event, 'majorCode')"
              >
              </ng-select>
            </div>
            <div
              class="col-12 col-md d-flex align-items-end"
              style="height: 68px; min-width: 89px"
            >
              <button type="submit" class="btn btn-primary">
                <i
                  class="bi bi-search"
                  style="font-size: var(--icon-size); color: var(--white-color)"
                ></i>
                ค้นหา
              </button>
            </div>
          </div>
        </form>
      </div>
      <div
        class="col-12 col-md ms-auto d-flex justify-content-end align-items-end mb-2 gap-2"
      >
        <div class="button-container d-flex justify-content-start gap-2">
          <!-- 1. click save data -->
          <button
            class="btn btn-primary"
            (click)="onSaveData()"
            style="max-height: 37.6px"
          >
            <i
              class="bi bi-floppy-fill"
              style="font-size: var(--icon-size); color: var(--white-color)"
            ></i>
            บันทึกข้อมูล
          </button>
          <button
            class="btn btn-secondary"
            (click)="onDelete()"
            style="max-height: 37.6px"
          >
            <i
              class="bi bi-trash-fill"
              style="font-size: var(--icon-size); color: var(--white-color)"
            ></i>
            ลบข้อมูล
          </button>
        </div>
      </div>
    </div>
    <!-- ag-Grid -->
    <ag-grid-angular
      *ngIf="isFileUploaded"
      style="width: 100%; height: 30.375rem"
      class="ag-theme-quartz"
      [rowData]="rowData"
      [columnDefs]="columnDefs"
      [defaultColDef]="defaultColDef"
    >
    </ag-grid-angular>
  </div>
</div>
